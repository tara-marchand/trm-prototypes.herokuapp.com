"use strict";var app=app||{};app.AppView=Backbone.View.extend({tagName:"div",className:"app",initialize:function(){this.graffitiCollection=new app.GraffitiCollection,this.graffitiCollection.fetch({success:function(){this.render()}.bind(this)})},render:function(){var e,t=new app.MapModel,a=new app.MapView({model:t});return"geolocation"in window.navigator&&window.navigator.geolocation.getCurrentPosition(function(e){t.set(e.coords.latitude),t.set(e.coords.longitude)},function(){}),this.$el.append(a.el),this.graffitiCollection.each(function(t){e=new app.GraffitiView({model:t}),this.$el.append(e.render().$el)}.bind(this)),this.$el.insertAfter($(".page-header")),a.init(),this}});var app=app||{};app.MapModel=Backbone.Model.extend({defaults:{lat:37.7792768,"long":-122.4192704,zoom:12,tileLayerUrl:"http://a.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',maxZoom:18}}),app.MapView=Backbone.View.extend({tagName:"section",className:"map",init:function(){var e=L.map(document.querySelector(".map")).setView([this.model.get("lat"),this.model.get("long")],this.model.get("zoom"));L.tileLayer(this.model.get("tileLayerUrl"),{attribution:this.model.get("attribution"),maxZoom:this.model.get("maxZoom")}).addTo(e)}});var app=app||{};app.GraffitiInstance=Backbone.Model.extend({defaults:{case_id:0,status:"-"}}),app.GraffitiCollection=Backbone.Collection.extend({model:app.GraffitiInstance,url:"https://data.sfgov.org/resource/p6sg-7yp7.json"}),app.GraffitiView=Backbone.View.extend({tagName:"p",template:_.template("<p>Case ID: <%= case_id %> - Status: <%= status %></p>"),render:function(){var e=this.model.toJSON();return this.$el.append(this.template(e)),this}});var app=app||{};app.appView=new app.AppView({collection:app.GraffitiCollection});